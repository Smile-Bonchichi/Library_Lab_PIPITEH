#include <iostream>
#include <ctime>
#include <string>
#include <fstream>
#include <iomanip>
#include "Windows.h"

using namespace std;

struct list {
	int item;
	list* next;
};

void listnum1(list* li, int& _count1);
void listnum2(list* li, int& _count2);

void inition(list* li, int k);
void push(list*& li, int k, int& count);
void add(list*& li, int& count);

void pop(list*& li, int k, int& count);
void deleLI(list*& li, int& count);

void output(list* li, int& count);

int searchByValue(list* li, int value, int& count);

void pushe(list*& li, int value, int& count);
void merger(list* li1, list* li2, int& count1, int& count2);

int main() {
	SetConsoleCP(1251);
	SetConsoleOutputCP(1251);

	const int n = 2;
	list* _List = new list[n];

	bool f = true;
	int choice, _count1 = 1, _count2 = 1;
	for (int i = 0; i < n; i++) {
		_List[i].item = i + 1;
		_List[i].next = NULL;
		inition(&_List[i], (i + 1));
	}
	while (f) {
		cout << "-----------------------------------------" << endl;
		cout << "|              Главное Меню:            |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|             1. Список № 1             |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|             2. Список № 2             |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|              3. Слияние               |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|               4. Выход                |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << endl;
		cout << "Введите номер операции:";
		cin >> choice;
		system("cls");
		switch (choice) {
		case 1: listnum1(&_List[0], _count1); break;
		case 2: listnum2(&_List[1], _count2); break;
		case 3: merger(&_List[0], &_List[1], _count1, _count2); break;
		case 4: f = false; break;
		default: cout << "Такой операции не существует!!!" << endl << "Введите заново." << endl; break;
		}
	}
	return 0;
}

void listnum1(list* li, int& _count1) {
	bool f = true;
	int choice;
	while (f) {
		cout << "-----------------------------------------" << endl;
		cout << "|        Главное Меню списка № 1:       |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|         1. Добавление элемента        |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|           2. Вывод элементов          |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|          3. Удаление элемента         |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|               4. Назад                |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << endl;
		cout << "Введите номер операции:";
		cin >> choice;
		system("cls");
		switch (choice) {
		case 1: add(li, _count1); break;
		case 2:	output(li, _count1); break;
		case 3: deleLI(li, _count1); break;
		case 4: f = false; break;
		default: cout << "Такой операции не существует!!!" << endl << "Введите заново." << endl; break;
		}
	}
}

void listnum2(list* li, int& _count2) {
	bool f = true;
	int choice;
	while (f) {
		cout << "-----------------------------------------" << endl;
		cout << "|        Главное Меню списка № 2:       |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|         1. Добавление элемента        |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|           2. Вывод элементов          |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|          3. Удаление элемента         |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|               4. Назад                |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << endl;
		cout << "Введите номер операции:";
		cin >> choice;
		system("cls");
		switch (choice) {
		case 1: add(li, _count2); break;
		case 2:	output(li, _count2); break;
		case 3: deleLI(li, _count2); break;
		case 4: f = false; break;
		default: cout << "Такой операции не существует!!!" << endl << "Введите заново." << endl; break;
		}
	}
}

void inition(list* li, int k) {
	int x;
	cout << "Инициализируйте первый элемент для списка № " << k << ":";
	cin >> x;
	system("cls");
	list* _li = new list;
	_li->item = x;
	li->next = _li;
	li->next->next = NULL;
	cout << "Первый элемент со значением = " << x << " инициализирован\n" << endl;
}

void push(list*& li, int k, int& count) {
	list* _li = new list;
	int j = 1, x;
	cout << "Введите новый элемент для добавления:";
	cin >> x;
	system("cls");
	_li->item = x;
	if (k == 1) {
		_li->next = li->next;
		li->next = _li;
	}
	else if (k == (count + 1)) {
		list* _LI = new list;
		_LI = li->next;
		while (_LI->next != 0) {
			_LI = _LI->next;
		}
		_LI->next = _li;
		_li->next = 0;
	}
	else {
		list* _LI = new list;
		_LI = li->next;
		while (_LI != 0) {
			if (j == k - 1) {
				_li->next = _LI->next;
				_LI->next = _li;
				break;
			}
			j++;
			_LI = _LI->next;
		}
	}
	count++;
	cout << "Элемент " << x << " успешно добавлен";
}

void add(list*& li, int& count) {
	bool f = true, f1 = true;
	int x, check;
	while (f) {
		cout << "-----------------------------------------" << endl;
		cout << "|            Меню добавления:           |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|       1. Добавление по индексу        |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|  2. Добавление до указанного элемента |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|3. Добавление после указанного элемента|" << endl;
		cout << "-----------------------------------------" << endl;
		cout << "|               4. Назад                |" << endl;
		cout << "-----------------------------------------" << endl;
		cout << endl;
		cout << "Введите номер операции:";
		cin >> x;
		system("cls");
		if (x == 1) {
			while (f1) {
				cout << "Введите индекс куда добавить:";
				cin >> x;
				system("cls");
				if (x <= 0 || x > (count + 1)) {
					cout << "Вы вышли за границы списка!!!" << endl << "Повторите заново ввод!!!" << endl;
				}
				else {
					f1 = false;
					f = false;
					push(li, x, count);
					cout << " в индекс = " << x << endl;
				}
			}
		}
		else if (x == 2) {
			if (count <= 0) {
				cout << "Лист пуст, нельзя добавить до или после!!!" << endl;
			}
			else {
				while (f1) {
					cout << "Введите значение элемента до которого добавить:";
					cin >> x;
					system("cls");
					check = searchByValue(li, x, count);
					if (check == 0) {
						cout << "Введенного элемента не существует." << endl << "Повторите заново ввод!!!" << endl;
					}
					else {
						f1 = false;
						f = false;
						push(li, check, count);
						cout << " до элемента " << x << endl;
					}
				}
			}
		}
		else if (x == 3) {
			if (count <= 0) {
				cout << "Лист пуст, нельзя добавить до или после!!!" << endl;
			}
			else {
				while (f1) {
					cout << "Введите значение элемента после которого добавить:";
					cin >> x;
					system("cls");
					check = searchByValue(li, x, count);
					if (check == 0) {
						cout << "Введенного элемента не существует." << endl << "Повторите заново ввод!!!" << endl;
					}
					else {
						f1 = false;
						f = false;
						push(li, (check + 1), count);
						cout << " после элемента " << x << endl;
					}
				}
			}
		}
		else if (x == 4) {
			f = false;
		}
		else {
			cout << "Такой операции не существует!!!" << endl << "Введите заново." << endl;
		}
	}
}

void output(list* li, int& count) {
	if (count <= 0) {
		cout << "Лист пуст, нечего выводить!!!" << endl;
	}
	else {
		cout << "Cписок № " << li->item << endl;
		int i = 1;
		list* _li = li->next;
		cout << "------------------------------------" << endl;
		cout << "|\tЭлементы\t:   Индекс |\n";
		cout << "------------------------------------" << endl;
		while (_li != 0) {
			cout << "|\t" << _li->item << "\t\t:     " << i << "\t   |" << endl;
			cout << "------------------------------------" << endl;
			_li = _li->next;
			i++;
		}
	}
}

void pop(list*& li, int k, int& count) {
	list* _li = new list;
	int x;
	if (k == 1) {
		_li = li->next;
		li->next = _li->next;
		x = _li->item;
		cout << "Элемент " << _li->item << " успешно удален" << endl;
		delete _li;
	}
	else if (k == count) {
		list* _LI = new list;
		_LI = li;
		while (_LI->next != 0) {
			_li = _LI;
			_LI = _LI->next;
		}
		x = _LI->item;
		cout << "Элемент " << _LI->item << " успешно удален" << endl;
		delete _LI;
		_li->next = 0;
	}
	else {
		int j = 1;
		list* _LI = new list;
		_LI = li->next;
		while (_LI != 0) {
			if (j == k) {
				_li->next = _LI->next;
				x = _LI->item;
				cout << "Элемент " << _LI->item << " успешно удален" << endl;
				delete _LI;
				break;
			}
			j++;
			_li = _LI;
			_LI = _LI->next;
		}
	}
	count--;
	if (count == 0) {
		li->next = 0;
	}
}

void deleLI(list*& li, int& count) {
	if (count <= 0) {
		cout << "Лист пуст, нечего удалять!!!" << endl;
	}
	else {
		bool f = true, f1 = true;
		int x, check;
		while (f) {
			cout << "-----------------------------------------" << endl;
			cout << "|              Меню удаления:           |" << endl;
			cout << "-----------------------------------------" << endl;
			cout << "|         1. Удаление по индексу        |" << endl;
			cout << "-----------------------------------------" << endl;
			cout << "|   2. Удаление до указанного элемента  |" << endl;
			cout << "-----------------------------------------" << endl;
			cout << "| 3. Удаление после указанного элемента |" << endl;
			cout << "-----------------------------------------" << endl;
			cout << "|         4. Удаление по значению       |" << endl;
			cout << "-----------------------------------------" << endl;
			cout << "|               5. Назад                |" << endl;
			cout << "-----------------------------------------" << endl;
			cout << endl;
			cout << "Введите номер операции:";
			cin >> x;
			system("cls");
			if (x == 1) {
				while (f1) {
					cout << "Введите индекс откуда удалить:";
					cin >> x;
					system("cls");
					if (x <= 0 || x > (count + 1)) {
						cout << "Вы вышли за границы списка!!!" << endl << "Повторите заново ввод!!!" << endl;
					}
					else {
						f1 = false;
						f = false;
						pop(li, x, count);
					}
				}
			}
			else if (x == 2) {
				while (f1) {
					cout << "Введите значение элемента до которого удалить:";
					cin >> x;
					system("cls");
					check = searchByValue(li, x, count);
					if (check == 0) {
						cout << "Введенного элемента не существует." << endl << "Повторите заново ввод!!!" << endl;
					}
					else {
						f1 = false;
						f = false;
						if (check == 1) {
							cout << "Нельзя удалить до " << x << " \nПотому что там ничего нет!!!" << endl;
						}
						else {
							pop(li, (check - 1), count);
						}
					}
				}
			}
			else if (x == 3) {
				while (f1) {
					cout << "Введите значение элемента после которого удалить:";
					cin >> x;
					system("cls");
					check = searchByValue(li, x, count);
					if (check == 0) {
						cout << "Введенного элемента не существует." << endl << "Повторите заново ввод!!!" << endl;
					}
					else {
						f1 = false;
						f = false;
						if (check == count) {
							cout << "Нельзя удалить после " << x << " \nПотому что там ничего нет!!!" << endl;
						}
						else {
							pop(li, (check + 1), count);
						}
					}
				}
			}
			else if (x == 4) {
				while (f1) {
					cout << "Введите значение элемента который будем удалять:";
					cin >> x;
					system("cls");
					check = searchByValue(li, x, count);
					if (check == 0) {
						cout << "Введенного элемента не существует." << endl << "Повторите заново ввод!!!" << endl;
					}
					else {
						f1 = false;
						f = false;
						pop(li, check, count);
					}
				}
			}
			else if (x == 5) {
				f = false;
			}
			else {
				cout << "Такой операции не существует!!!" << endl << "Введите заново." << endl;
			}
		}
	}
}

int searchByValue(list* li, int value, int& count) {
	int i = 1, j, kol = 0, k = 0, x;
	bool f = true;

	list* _li = new list;
	_li = li->next;

	while (_li != 0) {
		if (_li->item == value) {
			kol++;
			j = i;
		}
		i++;
		_li = _li->next;
	}
	if (kol == 0) {
		return 0;
	}
	else if (kol == 1) {
		return j;
	}
	else {
		while (f) {
			for (i = 0; i < kol; i++) {
				cout << i + 1 << "\t|" << value << endl;
			}
			cout << "Мы нашли " << kol << " элемента с введённым значение, выберите 1 из них:";
			cin >> x;
			system("cls");
			if (x <= 0 || x > kol) {
				cout << "Ошибка при вводе!!!" << endl;
			}
			else {
				f = false;
				i = 1;
				_li = li->next;
				while (_li != 0) {
					if (_li->item == value) {
						j = i;
						k++;
					}
					if (k == x) {
						break;
					}
					i++;
					_li = _li->next;
				}
				return j;
			}
		}
	}
	return 0;
}

void pushe(list*& li, int value, int& count) {
	list* _li = new list;
	_li->item = value;
	int j = 1;
	list* _LI = new list;
	_LI = li->next;
	while (_LI->next != 0) {
		_LI = _LI->next;
	}
	_LI->next = _li;
	_li->next = 0;
	count++;
}

void merger(list* li1, list* li2, int& count1, int& count2) {
	if (count1 != 0 && count2 != 0) {
		list* _li1 = new list;		//четные			2 4 6 8
		list* _li2 = new list;		//не четные			1 3 5 7
		_li1 = li1->next;			//					2 1 4 3 6 5 8 7
		_li2 = li2->next;
		int i = 0, n = count1 + count2, chet = 0, nechet = 1;

		int arr[100] = { 0 }, arr2[100] = { 0 };

		while (_li1 != 0) {
			arr[i] = _li1->item;
			_li1 = _li1->next;
			i++;
		}
		while (_li2 != 0) {
			arr[i] = _li2->item;
			_li2 = _li2->next;
			i++;
		}

		for (i = 0; i < n; i++) {
			if ((arr[i] % 2) == 0) {
				arr2[chet] = arr[i];
				chet += 2;
			}
			else {
				arr2[nechet] = arr[i];
				nechet += 2;
			}
		}
		li1->next = 0;
		li2->next = 0;
		count1 = 0;
		count2 = 0;

		list* _li = new list;
		_li->item = arr2[0];
		li1->next = _li;
		li1->next->next = NULL;
		count1++;
		for (i = 1; i < n; i++) {
			pushe(li1, arr2[i], count1);
		}
	}
	else if (count1 == 0) {
		cout << "Первый список пуст!!!" << endl;
		
	}
	else if (count2 == 0) {
		cout << "Второй список пуст!!!" << endl;
	}
	else {
		cout << "Оба списока пусты!!!" << endl;
	}
}